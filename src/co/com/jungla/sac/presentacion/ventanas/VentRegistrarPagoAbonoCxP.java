package co.com.jungla.sac.presentacion.ventanas;

import java.text.NumberFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;
import java.util.Locale;

import javax.swing.JFormattedTextField;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JLabel;
import javax.swing.JComboBox;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.JButton;

import co.com.jungla.sac.persistencia.entidades.AnticipoProveedor;
import co.com.jungla.sac.persistencia.entidades.Contabilizacion;
import co.com.jungla.sac.persistencia.entidades.CuentaXPagar;
import co.com.jungla.sac.persistencia.entidades.DevolucionProveedor;
import co.com.jungla.sac.persistencia.entidades.MedioPagoProv;
import co.com.jungla.sac.persistencia.entidades.Egreso;
import co.com.jungla.sac.persistencia.entidades.PagoAbonoCxP;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import java.awt.event.FocusAdapter;
import java.awt.event.FocusEvent;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.Font;
import java.awt.Color;
import java.awt.Toolkit;

import javax.swing.border.LineBorder;
import javax.swing.text.DefaultFormatterFactory;
import javax.swing.text.NumberFormatter;

import co.com.jungla.sac.negocio.delegados.DelegadoAnticipoProveedor;
import co.com.jungla.sac.negocio.delegados.DelegadoContabilizacion;
import co.com.jungla.sac.negocio.delegados.DelegadoCuentaXPagar;
import co.com.jungla.sac.negocio.delegados.DelegadoDevolucionProveedor;
import co.com.jungla.sac.negocio.delegados.DelegadoEgreso;
import co.com.jungla.sac.negocio.delegados.DelegadoMedioPagoProv;
import co.com.jungla.sac.negocio.delegados.DelegadoPagoAbonoCxP;
import com.toedter.calendar.JDateChooser;
import javax.swing.JTextPane;
import javax.swing.UIManager;
import javax.swing.JSeparator;

public class VentRegistrarPagoAbonoCxP extends JFrame {

	private JPanel contentPane;
	private JFormattedTextField txtSubtotal;
	private JFormattedTextField txtOtros;
	private JFormattedTextField txtTotalCxP;
	private DefaultComboBoxModel modeloFormaPago1 = new DefaultComboBoxModel();
	private DefaultComboBoxModel modeloFormaPago2 = new DefaultComboBoxModel();
	private JTextField txtDocSoporte;
	private JTextPane txpObservaciones;
	private JTextField txtCxP;
	private JTextField txtProveedor;
	private JTextField txtConcepto;
	private JTextField txtFechaCausacion;
	private JFormattedTextField txtTotalAbonado;
	public static JFormattedTextField txtDevoluciones;
	public static JFormattedTextField txtAnticipos;
	public  JFormattedTextField txtSaldoPagar;
	private JFormattedTextField txtPagoAbono;
	private JFormattedTextField txtValorPago1;
	private JFormattedTextField txtValorPago2;
	private JDateChooser dchFechaPago;
	private JComboBox cbFormaPago1;
	private JComboBox cbFormaPago2;
	private JButton btnPagarCxP;
	private JTextPane txpFechaProgramada;
	private int idEgreso = 0;
	private String idProveedor;
	private String formaPagoNula;
	private int numeroDeAnticipos = 0;
	private int numeroDeDevoluciones = 0;
	private Date fechaEgreso;
	private List<PagoAbonoCxP> codigoPagoAbonoCxP;
	private List<Egreso> codigoEgreso;
	

	/**
	 * Create the frame.
	 */
	
	public VentRegistrarPagoAbonoCxP() {
		setIconImage(Toolkit.getDefaultToolkit().getImage(VentRegistrarPagoAbonoCxP.class.getResource("/co/com/jungla/sac/presentacion/imagenes/Logo Jungla.png")));
		setTitle("Pago/Abono de Cuentas x Pagar");
		setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
		setBounds(100, 100, 557, 565);
		contentPane = new JPanel();
		contentPane.setBorder(new LineBorder(new Color(0, 51, 0), 2));
		setContentPane(contentPane);
		contentPane.setLayout(null);
		
		JLabel lblProveedor = new JLabel("Proveedor");
		lblProveedor.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblProveedor.setBounds(10, 101, 104, 14);
		contentPane.add(lblProveedor);
		
		JLabel lblConcepto = new JLabel("Concepto");
		lblConcepto.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblConcepto.setBounds(10, 121, 104, 14);
		contentPane.add(lblConcepto);
		
		JLabel lblFechaCausacion = new JLabel("Fecha Causacion");
		lblFechaCausacion.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblFechaCausacion.setBounds(10, 161, 117, 14);
		contentPane.add(lblFechaCausacion);
		
		JLabel lblSubtotal = new JLabel("Subtotal");
		lblSubtotal.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblSubtotal.setBounds(10, 181, 79, 14);
		contentPane.add(lblSubtotal);
		
		txtSubtotal = new JFormattedTextField(NumberFormat.getCurrencyInstance(new Locale("es","CO")));
		txtSubtotal.setEditable(false);
		txtSubtotal.setValue(0);
		txtSubtotal.setBounds(124, 178, 138, 20);
		contentPane.add(txtSubtotal);
		txtSubtotal.setColumns(10);
		
		JLabel lblOtros = new JLabel("Otros(+)");
		lblOtros.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblOtros.setBounds(10, 201, 79, 14);
		contentPane.add(lblOtros);
		
		txtOtros = new JFormattedTextField(NumberFormat.getCurrencyInstance(new Locale("es","CO")));
		txtOtros.setEditable(false);
		txtOtros.setValue(0);
		txtOtros.setBounds(124, 198, 138, 20);
		contentPane.add(txtOtros);
		txtOtros.setColumns(10);
		
		JLabel lblTotalCxP = new JLabel("Total CxP");
		lblTotalCxP.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblTotalCxP.setBounds(10, 221, 79, 14);
		contentPane.add(lblTotalCxP);
		
		txtTotalCxP = new JFormattedTextField(NumberFormat.getCurrencyInstance(new Locale("es","CO")));
		txtTotalCxP.setFont(new Font("Tahoma", Font.PLAIN, 11));
		txtTotalCxP.setForeground(new Color(255, 0, 0));
		txtTotalCxP.setEditable(false);
		txtTotalCxP.setValue(0);
		txtTotalCxP.setBounds(124, 218, 138, 20);
		contentPane.add(txtTotalCxP);
		
		JLabel lblObservaciones = new JLabel("Observaciones");
		lblObservaciones.setOpaque(true);
		lblObservaciones.setBackground(new Color(153, 204, 153));
		lblObservaciones.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblObservaciones.setBounds(10, 427, 112, 41);
		contentPane.add(lblObservaciones);
		 
		btnPagarCxP = new JButton("Pagar la CxP");
		btnPagarCxP.setForeground(new Color(0, 51, 0));
		btnPagarCxP.setFont(new Font("Tahoma", Font.BOLD, 11));
		btnPagarCxP.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				validarRegitro();
			}
		});
		btnPagarCxP.setBounds(156, 500, 117, 23);
		contentPane.add(btnPagarCxP);
		
		JButton btnCerrar = new JButton("Cerrar");
		btnCerrar.setForeground(new Color(0, 51, 0));
		btnCerrar.setFont(new Font("Tahoma", Font.BOLD, 11));
		btnCerrar.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				dispose();
			}
		});
		btnCerrar.setBounds(312, 500, 89, 23);
		contentPane.add(btnCerrar);
		
		txtDocSoporte = new JTextField();
		txtDocSoporte.setEditable(false);
		txtDocSoporte.setBounds(124, 138, 138, 20);
		contentPane.add(txtDocSoporte);
		txtDocSoporte.setColumns(10);
		
		JLabel lblDocSoporte = new JLabel("Doc. Soporte");
		lblDocSoporte.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblDocSoporte.setBounds(10, 141, 117, 14);
		contentPane.add(lblDocSoporte);
		
		txpObservaciones = new JTextPane();
		txpObservaciones.setBounds(124, 427, 414, 41);
		contentPane.add(txpObservaciones);
		
		JTextPane txpNota = new JTextPane();
		txpNota.setEditable(false);
		txpNota.setContentType("text/html");
		txpNota.setText("<FONT FACE=\"Tahoma\" SIZE= 3><p align=\"justify\"><b>NOTA: </b> Para registrar el PAGO de una Cuenta x Pagar que este registrada en sistema, debe traerla con el boton de busqueda. </p></FONT>");
		txpNota.setBackground(UIManager.getColor("Button.background"));
		txpNota.setBounds(10, 3, 526, 51);
		contentPane.add(txpNota);
		
		JLabel lblCxP = new JLabel("Cuenta por Pagar");
		lblCxP.setForeground(new Color(255, 0, 0));
		lblCxP.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblCxP.setBounds(10, 60, 117, 14);
		contentPane.add(lblCxP);
		
		JSeparator sp = new JSeparator();
		sp.setBackground(new Color(0, 51, 0));
		sp.setBounds(10, 85, 528, 2);
		contentPane.add(sp);
		
		txtCxP = new JTextField();
		txtCxP.setEditable(false);
		txtCxP.setBounds(124, 57, 194, 20);
		contentPane.add(txtCxP);
		
		JButton btnBuscar = new JButton("Buscar");
		btnBuscar.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				VentBuscarCxP ventBuscarCxP = new VentBuscarCxP();
				ventBuscarCxP.setVisible(true);
				setVisible(false);
			}
		});
		btnBuscar.setForeground(new Color(0, 51, 0));
		btnBuscar.setFont(new Font("Tahoma", Font.BOLD, 11));
		btnBuscar.setBounds(328, 56, 73, 23);
		contentPane.add(btnBuscar);
		
		txtProveedor = new JTextField();
		txtProveedor.setEditable(false);
		txtProveedor.setBounds(124, 98, 414, 20);
		contentPane.add(txtProveedor);
		txtProveedor.setColumns(10);
		
		txtConcepto = new JTextField();
		txtConcepto.setEditable(false);
		txtConcepto.setBounds(124, 118, 414, 20);
		contentPane.add(txtConcepto);
		txtConcepto.setColumns(10);
		
		txtFechaCausacion = new JTextField();
		txtFechaCausacion.setEditable(false);
		txtFechaCausacion.setBounds(124, 158, 138, 20);
		contentPane.add(txtFechaCausacion);
		txtFechaCausacion.setColumns(10);
		
		JSeparator sp1 = new JSeparator();
		sp1.setBackground(new Color(0, 51, 0));
		sp1.setBounds(10, 246, 528, 2);
		contentPane.add(sp1);
		
		JLabel lblTotalAbonado = new JLabel("Total Abonado (-)");
		lblTotalAbonado.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblTotalAbonado.setBounds(10, 262, 117, 14);
		contentPane.add(lblTotalAbonado);
		
		JLabel lblDevoluciones = new JLabel("Devoluciones (-)");
		lblDevoluciones.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblDevoluciones.setBounds(10, 282, 117, 14);
		contentPane.add(lblDevoluciones);
		
		txtTotalAbonado = new JFormattedTextField(NumberFormat.getCurrencyInstance(new Locale("es","CO")));
		txtTotalAbonado.setEditable(false);
		txtTotalAbonado.setValue(0);
		txtTotalAbonado.setBounds(124, 259, 138, 20);
		contentPane.add(txtTotalAbonado);
		
		txtDevoluciones = new JFormattedTextField(NumberFormat.getCurrencyInstance(new Locale("es","CO")));
		txtDevoluciones.setEditable(false);
		txtDevoluciones.setValue(0);
		txtDevoluciones.setBounds(124, 279, 138, 20);
		contentPane.add(txtDevoluciones);
		
		JLabel lblAnticipos = new JLabel("Anticipos (-)");
		lblAnticipos.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblAnticipos.setBounds(10, 302, 117, 14);
		contentPane.add(lblAnticipos);
		
		JLabel lblSaldoPagar = new JLabel("Saldo Por Pagar");
		lblSaldoPagar.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblSaldoPagar.setBounds(10, 322, 117, 14);
		contentPane.add(lblSaldoPagar);
		
		txtAnticipos = new JFormattedTextField(NumberFormat.getCurrencyInstance(new Locale("es","CO")));
		txtAnticipos.setEditable(false);
		txtAnticipos.setValue(0);
		txtAnticipos.setBounds(124, 299, 138, 20);
		contentPane.add(txtAnticipos);
		
		txtSaldoPagar = new JFormattedTextField(NumberFormat.getCurrencyInstance(new Locale("es","CO")));
		txtSaldoPagar.setEditable(false);
		txtSaldoPagar.setValue(0);
		txtSaldoPagar.setBounds(124, 319, 138, 20);
		contentPane.add(txtSaldoPagar);
		
		JLabel lblFechaPago = new JLabel("Fecha de Pago");
		lblFechaPago.setOpaque(true);
		lblFechaPago.setBackground(new Color(153, 204, 153));
		lblFechaPago.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblFechaPago.setBounds(10, 361, 112, 20);
		contentPane.add(lblFechaPago);
		
		dchFechaPago = new JDateChooser();
		dchFechaPago.setBounds(124, 361, 138, 20);
		contentPane.add(dchFechaPago);
		
		JLabel lblPagoAbono = new JLabel("Pago/Abono");
		lblPagoAbono.setOpaque(true);
		lblPagoAbono.setBackground(new Color(153, 204, 153));
		lblPagoAbono.setForeground(new Color(0, 51, 0));
		lblPagoAbono.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblPagoAbono.setBounds(10, 339, 112, 20);
		contentPane.add(lblPagoAbono);
		
		txtPagoAbono = new JFormattedTextField();
		txtPagoAbono.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				actualizarFormasPago();
				verificarPagoAbonoMayorASaldoPagar();
				cambiarTextoBotonPagarAbonar();
				//validarSaldoAPagarNegativo();
			}
		});
		txtPagoAbono.addMouseListener(new MouseAdapter() {
			@Override
			public void mouseClicked(MouseEvent e) {
				actualizarFormasPago();
				cambiarTextoBotonPagarAbonar();
				//verificarPagoAbonoMayorASaldoPagar();
				//validarSaldoAPagarNegativo();
			}
			@Override
			public void mousePressed(MouseEvent e) {
				actualizarFormasPago();
				cambiarTextoBotonPagarAbonar();
				verificarPagoAbonoMayorASaldoPagar();
				//validarSaldoAPagarNegativo();
			}
			@Override
			public void mouseEntered(MouseEvent e) {
				actualizarFormasPago();
				cambiarTextoBotonPagarAbonar();
				//verificarPagoAbonoMayorASaldoPagar();
				//validarSaldoAPagarNegativo();
			}
			@Override
			public void mouseExited(MouseEvent e) {
				actualizarFormasPago();
				cambiarTextoBotonPagarAbonar();
				//verificarPagoAbonoMayorASaldoPagar();
				//validarSaldoAPagarNegativo();
			}
			@Override
			public void mouseReleased(MouseEvent e) {
				actualizarFormasPago();
				cambiarTextoBotonPagarAbonar();
				//verificarPagoAbonoMayorASaldoPagar();
				//validarSaldoAPagarNegativo();
			}
		});
		txtPagoAbono.addFocusListener(new FocusAdapter() {
			@Override
			public void focusLost(FocusEvent e) {
				actualizarFormasPago();
				cambiarTextoBotonPagarAbonar();
				//verificarPagoAbonoMayorASaldoPagar();
				//validarSaldoAPagarNegativo();
			}
		});
		txtPagoAbono.setBackground(new Color(0, 153, 0));
		formatearAMoneda(txtPagoAbono);
		txtPagoAbono.setBounds(124, 339, 138, 20);
		contentPane.add(txtPagoAbono);
		
		JLabel lblFechaProgramada = new JLabel("Programada:");
		lblFechaProgramada.setForeground(new Color(0, 102, 204));
		lblFechaProgramada.setFont(new Font("Arial", Font.PLAIN, 12));
		lblFechaProgramada.setBounds(275, 361, 79, 20);
		contentPane.add(lblFechaProgramada);
		
		txpFechaProgramada = new JTextPane();
		txpFechaProgramada.setBackground(UIManager.getColor("Button.background"));
		txpFechaProgramada.setFont(new Font("Tahoma", Font.BOLD, 11));
		txpFechaProgramada.setEditable(false);
		txpFechaProgramada.setBounds(352, 361, 79, 20);
		contentPane.add(txpFechaProgramada);
		
		cbFormaPago1 = new JComboBox();
		cbFormaPago1.setBounds(124, 383, 275, 20);
		contentPane.add(cbFormaPago1);
		
		cbFormaPago2 = new JComboBox();
		cbFormaPago2.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				habilitarFormaPago2();
			}
		});
		cbFormaPago2.setBounds(124, 405, 275, 20);
		contentPane.add(cbFormaPago2);
		
		JLabel lblFormaPago1 = new JLabel("Forma de Pago 1");
		lblFormaPago1.setOpaque(true);
		lblFormaPago1.setBackground(new Color(153, 204, 153));
		lblFormaPago1.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblFormaPago1.setBounds(10, 383, 112, 20);
		contentPane.add(lblFormaPago1);
		
		JLabel lblFormaPago2 = new JLabel("Forma de Pago 2");
		lblFormaPago2.setOpaque(true);
		lblFormaPago2.setBackground(new Color(153, 204, 153));
		lblFormaPago2.setFont(new Font("Tahoma", Font.BOLD, 11));
		lblFormaPago2.setBounds(10, 405, 112, 20);
		contentPane.add(lblFormaPago2);
		
		JSeparator sp2 = new JSeparator();
		sp2.setBackground(new Color(0, 51, 0));
		sp2.setBounds(10, 479, 528, 2);
		contentPane.add(sp2);
		
		JButton btnBuscarDev = new JButton("Buscar");
		btnBuscarDev.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				if("".equals(idProveedor)){
					JOptionPane.showMessageDialog(null, "Debe buscar la CUENTA X PAGAR a la que se aplicara el ABONO o el PAGO TOTAL");
				}else{
					cargarADevolucionProveedor(idProveedor);
					
				}
			}
		});
		btnBuscarDev.setForeground(new Color(0, 51, 0));
		btnBuscarDev.setFont(new Font("Tahoma", Font.BOLD, 9));
		btnBuscarDev.setBounds(265, 279, 68, 20);
		contentPane.add(btnBuscarDev);
		
		JButton btnBuscarAnt = new JButton("Buscar");
		btnBuscarAnt.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				if("".equals(idProveedor)){
					JOptionPane.showMessageDialog(null, "Debe buscar la CUENTA X PAGAR a la que se aplicara el ABONO o el PAGO TOTAL");
				}else{
					cargarAAnticipoProveedor(idProveedor);
				}
			}
		});
		btnBuscarAnt.setForeground(new Color(0, 51, 0));
		btnBuscarAnt.setFont(new Font("Tahoma", Font.BOLD, 9));
		btnBuscarAnt.setBounds(265, 299, 68, 20);
		contentPane.add(btnBuscarAnt);
		
		JLabel lblDevolucionesC = new JLabel("Notas Debito por Devoluciones en Compras.");
		lblDevolucionesC.setFont(new Font("Tahoma", Font.PLAIN, 10));
		lblDevolucionesC.setBounds(337, 282, 201, 14);
		contentPane.add(lblDevolucionesC);
		
		JLabel lblAnticiposAProveedores = new JLabel("Anticipos a Proveedores.");
		lblAnticiposAProveedores.setFont(new Font("Tahoma", Font.PLAIN, 10));
		lblAnticiposAProveedores.setBounds(337, 302, 199, 14);
		contentPane.add(lblAnticiposAProveedores);
		
		txtValorPago1 = new JFormattedTextField();
		txtValorPago1.setEditable(false);
		formatearAMoneda(txtValorPago1);
		txtValorPago1.setBounds(400, 383, 138, 20);
		contentPane.add(txtValorPago1);
		
		txtValorPago2 = new JFormattedTextField();
		txtValorPago2.setEditable(false);
		formatearAMoneda(txtValorPago2);
		txtValorPago2.setBounds(400, 405, 138, 20);
		contentPane.add(txtValorPago2);
		
		JButton btnVerAnular = new JButton("Ver/Anular");
		btnVerAnular.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				if("".equals(txtCxP.getText())){
					JOptionPane.showMessageDialog(null, "Debe buscar la CUENTA X PAGAR a la que se aplicara el ABONO o el PAGO TOTAL");
				}else{
					cargarAPagoAbonoCxP(Integer.parseInt(txtCxP.getText()));
				}
			}
		});
		btnVerAnular.setForeground(new Color(0, 51, 0));
		btnVerAnular.setFont(new Font("Tahoma", Font.BOLD, 9));
		btnVerAnular.setBounds(265, 259, 100, 20);
		contentPane.add(btnVerAnular);
		
		JLabel lblVerAnular = new JLabel("Ver o anular Abonos");
		lblVerAnular.setFont(new Font("Tahoma", Font.PLAIN, 10));
		lblVerAnular.setBounds(369, 262, 124, 14);
		contentPane.add(lblVerAnular);
		
		listarFormaPagos1();
		listarFormaPagos2();
	}
	
	//Metodo que valida los datos ingresados para su posterior registro 
	private void validarRegitro() {
		String nl = System.getProperty("line.separator");
		if(txtCxP.getText().equals("")){
			JOptionPane.showMessageDialog(null, "Debe buscar la CUENTA POR PAGAR a la cual va a cancelar o abonar");
		}else{
			if(txtPagoAbono.getValue().equals(0)){
				JOptionPane.showMessageDialog(null, "No puede registrar un pago/abono sin valor");
			}else{
				if(dchFechaPago.getDate()==null){
					JOptionPane.showMessageDialog(null, "Debe ingresar una FECHA de PAGO correcta");
				}else{
					if(Double.parseDouble(desformatearNumero(txtSaldoPagar.getText()))<0){
						JOptionPane.showMessageDialog(null, "El saldo a pagar no puede tener un valor negativo");
					}else{
						if((Double.parseDouble(desformatearNumero(txtDevoluciones.getText()))>0||Double.parseDouble(desformatearNumero(txtDevoluciones.getText()))>0)&&(Double.parseDouble(txtSaldoPagar.getValue().toString())!=Double.parseDouble(txtPagoAbono.getValue().toString()))){
							JOptionPane.showMessageDialog(null, "Las NOTAS DEBITO y los ANTICIPOS se deben descontar solo cuando se efectue el PAGO TOTAL de la CXP."+nl+nl+"Despues de dar aceptar se quitaran las NOTAS Y ANTICIPOS seleccionados","ERROR",JOptionPane.ERROR_MESSAGE);
							txtDevoluciones.setValue(0);
							txtAnticipos.setValue(0);
						}else{
							if(Double.parseDouble(txtSaldoPagar.getValue().toString())==Double.parseDouble(txtPagoAbono.getValue().toString())){
								if((Double.parseDouble(txtValorPago1.getValue().toString()) + Double.parseDouble(txtValorPago2.getValue().toString())) == Double.parseDouble(txtPagoAbono.getValue().toString())){
									int res = JOptionPane.showConfirmDialog(null, "Esta seguro de grabar este PAGO TOTAL de la CXP", null, JOptionPane.YES_NO_OPTION);
									if(res==0){
										ingresarPagoAbono();
										registrarEgreso();
									}else{
									}
								}else{
									JOptionPane.showMessageDialog(null, "La suma de los VALORES de las FORMAS DE PAGO deben ser igual al Pago/Abono: "+txtPagoAbono.getText(),"ERROR",JOptionPane.ERROR_MESSAGE);
								}
								
							}else{
								if((Double.parseDouble(txtValorPago1.getValue().toString()) + Double.parseDouble(txtValorPago2.getValue().toString())) == Double.parseDouble(txtPagoAbono.getValue().toString())){
									int res = JOptionPane.showConfirmDialog(null, "Esta seguro de grabar este ABONO y dejar pendiente un nuevo saldo  "+formatearNumero(calcularNuevoSaldo())+" ?", null, JOptionPane.YES_NO_OPTION);
									if(res==0){
										ingresarPagoAbono();
									}else{
									}
								}else{
									JOptionPane.showMessageDialog(null, "La suma de los VALORES de las FORMAS DE PAGO deben ser igual al Pago/Abono: "+txtPagoAbono.getText(),"ERROR",JOptionPane.ERROR_MESSAGE);
								}
							}
						}
						
						
					/*	if(cbFormaPago1.getSelectedItem()!=null && cbFormaPago2.getSelectedItem()!="--NINGUNA--"){
							if((Double.parseDouble(txtValorPago1.getValue().toString()) + Double.parseDouble(txtValorPago2.getValue().toString())) == Double.parseDouble(txtPagoAbono.getValue().toString())){
								if(Double.parseDouble(txtSaldoPagar.getValue().toString())==Double.parseDouble(txtPagoAbono.getValue().toString())){
									int res = JOptionPane.showConfirmDialog(null, "Esta seguro de grabar este PAGO TOTAL de la CXP", null, JOptionPane.YES_NO_OPTION);
									if(res==0){
										ingresarPagoAbono();
										try{
											ingresarGastoYOEgreso();
										}catch(Exception ex){
											ex.getMessage();
										}
									}else{
									
									}
								}else{
									int res = JOptionPane.showConfirmDialog(null, "Esta seguro de grabar este ABONO y dejar pendiente un nuevo saldo  "+formatearNumero(calcularNuevoSaldo())+" ?", null, JOptionPane.YES_NO_OPTION);
									if(res==0){
										ingresarPagoAbono();
										try{
											ingresarGastoYOEgreso();
										}catch(Exception ex){
											ex.getMessage();
										}
									}else{
									
									}
								}
								
							}else{
								JOptionPane.showMessageDialog(null, "La suma de los VALORES de las FORMAS DE PAGO deben ser igual al Pago/Abono: "+txtPagoAbono.getText(),"ERROR",JOptionPane.ERROR_MESSAGE);
							}
							
						}else{
							if((Double.parseDouble(txtValorPago1.getValue().toString()) + Double.parseDouble(txtValorPago2.getValue().toString())) == Double.parseDouble(txtPagoAbono.getValue().toString())){
								if(Double.parseDouble(txtSaldoPagar.getValue().toString())==Double.parseDouble(txtPagoAbono.getValue().toString())){
									int res = JOptionPane.showConfirmDialog(null, "Esta seguro de grabar este PAGO TOTAL de la CXP", null, JOptionPane.YES_NO_OPTION);
									if(res==0){
										ingresarPagoAbono();
										try{
											ingresarGastoYOEgreso();
										}catch(Exception ex){
											ex.getMessage();
										}
									}else{
									
									}
								}else{
									int res = JOptionPane.showConfirmDialog(null, "Esta seguro de grabar este ABONO y dejar pendiente un nuevo saldo  "+formatearNumero(calcularNuevoSaldo())+" ?", null, JOptionPane.YES_NO_OPTION);
									if(res==0){
										ingresarPagoAbono();
										try{
											ingresarGastoYOEgreso();
										}catch(Exception ex){
											ex.getMessage();
										}
									}else{
									
									}
								}
								
							}else{
								JOptionPane.showMessageDialog(null, "La suma de los VALORES de las FORMAS DE PAGO deben ser igual al Pago/Abono: "+txtPagoAbono.getText(),"ERROR",JOptionPane.ERROR_MESSAGE);
							}
						}*/
					}
				}
			}
		}
	}
	
	//Limpiar los datos escritos 
	public void limpiar() {
		
		txtCxP.setText("");
		txtProveedor.setText("");
		txtConcepto.setText("");
		txtDocSoporte.setText("");
		txtFechaCausacion.setText("");
		txtSubtotal.setValue(0);
		txtOtros.setValue(0);
		txtTotalCxP.setValue(0);
		txtTotalAbonado.setValue(0);
		txtDevoluciones.setValue(0);
		txtAnticipos.setValue(0);
		txtSaldoPagar.setValue(0);
		txtPagoAbono.setValue(0);
		dchFechaPago.setCalendar(null);
		cbFormaPago1.setSelectedIndex(0);
		cbFormaPago2.setSelectedIndex(0);
		txtValorPago1.setValue(0);
		txtValorPago2.setValue(0);
		txpObservaciones.setText("");
	}
	
	//Metodo para convertir una fecha de tipo date a una cadena
	public String convertirDateAString(Date strFecha){
		SimpleDateFormat formateador = new SimpleDateFormat("dd/MM/yyyy");
		String fecha = formateador.format(strFecha);
		
		return fecha;
	}
	//Metodo para registrar la cuenta por pagar a la base de datos luego de haberse validado
	private void ingresarPagoAbono() {
		DelegadoPagoAbonoCxP delegadoPagoAbonoCxP = new DelegadoPagoAbonoCxP();
		PagoAbonoCxP pagoAbonoCxP = new PagoAbonoCxP();
		CuentaXPagar cuentaXPagar = new CuentaXPagar();
		MedioPagoProv medioPago1 = new MedioPagoProv();
		MedioPagoProv medioPago2 = new MedioPagoProv();
		
		cuentaXPagar.setIdCuentaXPagar(Integer.parseInt(txtCxP.getText()));
		pagoAbonoCxP.setCuentaXPagar(cuentaXPagar);
		pagoAbonoCxP.setTotalAbonado(Double.parseDouble(txtTotalAbonado.getValue().toString()));
		pagoAbonoCxP.setTotalDevoluciones(Double.parseDouble(desformatearNumero(txtDevoluciones.getText())));
		pagoAbonoCxP.setTotalAnticipos(Double.parseDouble(desformatearNumero(txtAnticipos.getText())));
		pagoAbonoCxP.setSaldoPagar(Double.parseDouble(txtSaldoPagar.getValue().toString()));
		pagoAbonoCxP.setPagoAbono(Double.parseDouble(txtPagoAbono.getValue().toString()));
		pagoAbonoCxP.setFechaPago(dchFechaPago.getDate());
		medioPago1 = (MedioPagoProv)cbFormaPago1.getSelectedItem();
		medioPago1.setIdMedioPagoProv(medioPago1.getIdMedioPagoProv());
		pagoAbonoCxP.setMedioPagoProv1(medioPago1);
		if(cbFormaPago2.getSelectedItem().equals("--NINGUNA--")){
			pagoAbonoCxP.setMedioPagoProv2(null);
		}else{
			medioPago2 = (MedioPagoProv)cbFormaPago2.getSelectedItem();
			medioPago2.setIdMedioPagoProv(medioPago2.getIdMedioPagoProv());
			pagoAbonoCxP.setMedioPagoProv2(medioPago2);
		}
		pagoAbonoCxP.setValorPago1(Double.parseDouble(txtValorPago1.getValue().toString()));
		pagoAbonoCxP.setValorPago2(Double.parseDouble(txtValorPago2.getValue().toString()));
		pagoAbonoCxP.setEstadoAnular("Vigente");
		pagoAbonoCxP.setFechaGeneracion(new Date());
		pagoAbonoCxP.setObservaciones(txpObservaciones.getText());
		
		delegadoPagoAbonoCxP.insertarPagoAbonoCxP(pagoAbonoCxP);
		codigoPagoAbonoCxP = delegadoPagoAbonoCxP.traerCodigoPagoAbonoCxP();
		try{
			formaPagoNula = codigoPagoAbonoCxP.get(0).getMedioPagoProv1().getDescripcion();
		}catch(NullPointerException nl){
			formaPagoNula = "";
			nl.getMessage();
		}
		/*if(codigoPagoAbonoCxP.get(0).getFormaPago2().getDescripcion()==null){
			formaPagoNula = "";
		}else{
			formaPagoNula = codigoPagoAbonoCxP.get(0).getFormaPago2().getDescripcion();
		}*/
		if(Double.parseDouble(desformatearNumero(txtAnticipos.getText()))!=0){
			cambiarEstadoAnticipo();
		}
		
		if(Double.parseDouble(desformatearNumero(txtDevoluciones.getText()))!=0){
			cambiarEstadoDevolucion();
		}
		
		verificarPagoAbonoCxP(String.valueOf(codigoPagoAbonoCxP.get(0).getIdAbono()),idEgreso, codigoPagoAbonoCxP.get(0).getMedioPagoProv1().getDescripcion(), formaPagoNula);
		contabilizarPagoAbono();
	}

	private void verificarPagoAbonoCxP(String idAbono, int idEgreso, String formaPago1, String formaPago2) { 
		VentVerificarPagoAbonoCxP ventVerificarPagoAbonoCxP = new VentVerificarPagoAbonoCxP(txtCxP.getText(),idAbono, idEgreso, convertirDateAString(dchFechaPago.getDate()), txtSubtotal.getText(), txtOtros.getText(), txtTotalCxP.getText(), txtDevoluciones.getText(), txtAnticipos.getText(), txtPagoAbono.getText(), String.valueOf(calcularNuevoSaldo()),formaPago1, formaPago2, txpObservaciones.getText());
		ventVerificarPagoAbonoCxP.setVisible(true);
		limpiar();
	}
	
	//Metodo para formatear a moneda peso permitiendo la edicion y visualizacion
	private void formatearAMoneda(JFormattedTextField campoTexto) {
		
		campoTexto.setFocusLostBehavior(JFormattedTextField.COMMIT_OR_REVERT);
		campoTexto.setValue(0);
		NumberFormat visNf = NumberFormat.getCurrencyInstance(); 
		NumberFormat ediNf = NumberFormat.getNumberInstance(new Locale("es","CO"));
		ediNf.setGroupingUsed(false);
		NumberFormatter visNt = new NumberFormatter(visNf);
		NumberFormatter ediNt = new NumberFormatter(ediNf);
		DefaultFormatterFactory currFactory = new DefaultFormatterFactory(visNt, visNt, ediNt);
		ediNt.setAllowsInvalid(true);
		
		campoTexto.setFormatterFactory(currFactory);
	}
	
	//Metodo para Habilitar combo box de la forma de pago 2 para su puesta modificacion
	private void habilitarFormaPago2() {
		if(cbFormaPago2.getSelectedItem().equals("--NINGUNA--")){
			txtValorPago1.setEditable(false);
			txtValorPago2.setEditable(false);
			actualizarFormasPago();
		}else{
			JOptionPane.showMessageDialog(null, "Debe indicar el VALOR TOTAL PAGADO con cada una de las FORMAS de PAGO iniciando por la principal", "ATENCION",  JOptionPane.INFORMATION_MESSAGE);
			txtValorPago1.setValue(0);
			txtValorPago1.setEditable(true);
			txtValorPago2.setEditable(true);
		}
	}
	//Metodo para actualizar las formas de pago elegidas segun el criterio del usuario final
	private void actualizarFormasPago() {
		if(cbFormaPago1.getSelectedItem()!=null && cbFormaPago2.getSelectedItem()!="--NINGUNA--"){
			txtValorPago1.setValue(txtPagoAbono.getValue());
		}else{
			txtValorPago1.setValue(txtPagoAbono.getValue());
			txtValorPago2.setValue(0);
		}
	}
	//Metodo para calcular el nuevo saldo hallando la diferencia entre el saldo a pagar y el valor del abono
	private double calcularNuevoSaldo(){
		double nuevoSaldo = Double.parseDouble(txtSaldoPagar.getValue().toString()) - Double.parseDouble(txtPagoAbono.getValue().toString());
		return nuevoSaldo;
	}
	//Metodo para calcular el saldo a pagar hallando la diferencia entre el total de la cxp y el total abonado (es decir, los abonos que ya se han hecho)
	public void calcularSaldoAPagar(){
		double saldoAPagar = Double.parseDouble(txtTotalCxP.getValue().toString()) - (Double.parseDouble(txtTotalAbonado.getValue().toString())+Double.parseDouble(desformatearNumero(txtDevoluciones.getText())) + Double.parseDouble(desformatearNumero(txtAnticipos.getText()))) ;
		txtSaldoPagar.setValue(saldoAPagar);
	}
	
	//Metodo para agregar los datos de la Cuenta por Pagar al Pago o abono de la cuenta por pagar
	public void agregarDatosAPagoAbonoCxP(int idCuentaxPagar, String concepto, int docSoporte, Date fechaCausacion, double subtotal, double otros, double totalPagar, List<PagoAbonoCxP> listaPagoAbonoCxP, Date fechaPago, String proveedor, String identificacion ){

		txtCxP.setText(Integer.toString(idCuentaxPagar));
		txtProveedor.setText(proveedor);
		txtConcepto.setText(concepto);
		txtDocSoporte.setText(String.valueOf(docSoporte));
		txtFechaCausacion.setText(convertirDateAString(fechaCausacion));
		txtSubtotal.setValue(subtotal);
		txtOtros.setValue(otros);
		txtTotalCxP.setValue(totalPagar);
		dchFechaPago.setDate(null);
		dchFechaPago.setSelectableDateRange(fechaCausacion, new Date());
		txpFechaProgramada.setText(convertirDateAString(fechaPago));
		txtTotalAbonado.setValue(calcularTotalAbonado(listaPagoAbonoCxP));
		calcularSaldoAPagar();
		idProveedor = String.valueOf(identificacion);
		verNumeroAnticipos();
		verNumeroDevoluciones();
	}
	
	//Metodo para mostrar el numero de anticipos que tiene el proveedor elegido
	private void verNumeroAnticipos(){
		DelegadoAnticipoProveedor delegadoAnticipoProveedor = new DelegadoAnticipoProveedor();
		List<AnticipoProveedor> anticipos = delegadoAnticipoProveedor.listarAnticipoProveedorPorIdentificacion(String.valueOf(idProveedor));
		for(AnticipoProveedor listaAnticipos : anticipos ){
			if("Contado".equals(listaAnticipos.getEstadoAnticipo())){
				numeroDeAnticipos++;
			}
		}
		if(numeroDeAnticipos == 0){
		}else{
			String nl = System.getProperty("line.separator");
			JOptionPane.showMessageDialog(null, "Existen " +numeroDeAnticipos+" ANTICIPOS para descontarse con este proveedor."+nl+nl+"Para usarlos de clic en el boton buscar al lado del campo de [Anticipos] y"+nl+"seleccione los Anticipos que desee descontarse en el pago de esta CxP.","ATENCION",JOptionPane.INFORMATION_MESSAGE);
		}
	}
	//Metodo para mostrar el numero de devoluciones que tiene el proveedor elegido
	private void verNumeroDevoluciones(){
		DelegadoDevolucionProveedor delegadoDevolucionProveedor = new DelegadoDevolucionProveedor();
		List<DevolucionProveedor> devoluciones = delegadoDevolucionProveedor.listarDevolucionProveedorPorIdentificacion(String.valueOf(idProveedor));
		for(DevolucionProveedor listaDevoluciones : devoluciones ){
			if("Pendiente".equals(listaDevoluciones.getEstado())){
				numeroDeDevoluciones++;
			}
		}
		if(numeroDeDevoluciones == 0){
		}else{
			String nl = System.getProperty("line.separator");
			JOptionPane.showMessageDialog(null, "Existen " +numeroDeDevoluciones+" NOTAS DEBITOS para descontarse con este proveedor."+nl+nl+"Para usarlos de clic en el boton buscar al lado del campo de [Devoluciones] y"+nl+"seleccione las notas que desee descontarse en el pago de esta CxP.","ATENCION",JOptionPane.INFORMATION_MESSAGE);
		}
	}
		
	//Metodo para listar formas de pagos y desplegarlos en un combo box
	private void listarFormaPagos1() {
		DelegadoMedioPagoProv delegadoFormaPago = new DelegadoMedioPagoProv();
		List<MedioPagoProv> mediosPago = delegadoFormaPago.listarFormaPago();
		cbFormaPago1.setModel(modeloFormaPago1);
		
		for(MedioPagoProv medioPago : mediosPago){
			modeloFormaPago1.addElement(new MedioPagoProv (medioPago.getDescripcion(), medioPago.getIdMedioPagoProv()));
			cbFormaPago1.setModel(modeloFormaPago1);
		}
	}
	
	//Metodo para listar formas de pagos y desplegarlos en un combo box
	private void listarFormaPagos2() {
		DelegadoMedioPagoProv delegadoFormaPago = new DelegadoMedioPagoProv();
		List<MedioPagoProv> mediosPago = delegadoFormaPago.listarFormaPago();
		modeloFormaPago2.addElement("--NINGUNA--");
		cbFormaPago2.setModel(modeloFormaPago2);
		
		for(MedioPagoProv medioPago : mediosPago){
			modeloFormaPago2.addElement(new MedioPagoProv (medioPago.getDescripcion(), medioPago.getIdMedioPagoProv()));
			cbFormaPago2.setModel(modeloFormaPago2);
		}
	}
	//Metodo para calcular todos los abonos que se han realizado en la cuenta por pagar incluyendo sus abonos anulados
	private double calcularTotalAbonado(List<PagoAbonoCxP> listaPagoAbonoCxP){
		double totalAnulados = 0;
		double totalVigentes = 0;
		double totalAbonado;
		
		for(PagoAbonoCxP pagosAbonos : listaPagoAbonoCxP ){
			if("Anulado".equals(pagosAbonos.getEstadoAnular())){
				totalAnulados += pagosAbonos.getPagoAbono();
			}else{
				totalVigentes += pagosAbonos.getPagoAbono();
			}
		}
		if((totalVigentes-totalAnulados)<=0){
			totalAbonado = 0;
		}else{
			totalAbonado = totalVigentes-totalAnulados;
		}
		return totalAbonado;
	}
	//Metodo para verificar que el valor del abono no sobrepase el saldo a pagar
	private void verificarPagoAbonoMayorASaldoPagar(){
		if(Double.parseDouble(txtPagoAbono.getValue().toString())>Double.parseDouble(txtSaldoPagar.getValue().toString())){
			JOptionPane.showMessageDialog(null, "El ABONO no puede ser mayor al SALDO de la CxP","ERROR",JOptionPane.ERROR_MESSAGE);
			txtPagoAbono.setValue(0);
		}else{
		}
	}
	
	//Metodo para cargar los datos del abono a la ventana de abonos a CxP
	public void cargarAPagoAbonoCxP(int idCuentaxPagar){
		
		try{
			DelegadoPagoAbonoCxP delegadoPagoAbonoCxP = new DelegadoPagoAbonoCxP();
			VentBuscarAbonosACxP ventAbonosACxP = new VentBuscarAbonosACxP();
			List<PagoAbonoCxP> abonos = delegadoPagoAbonoCxP.listarPagoAbonoCxPPorCodigoCxP(idCuentaxPagar);
			ventAbonosACxP.agregarDatosAbonos(abonos);
			ventAbonosACxP.setVisible(true);
		}catch(NullPointerException nl){
			VentBuscarAbonosACxP ventAbonosACxP = new VentBuscarAbonosACxP();
			ventAbonosACxP.setVisible(true);
			nl.getMessage();
		}
		
	}
	
	//Metodo para cargar los datos del anticipo a la ventana de anticipos proveedor
	public void cargarAAnticipoProveedor(String identificacion){
	
		try{
			DelegadoAnticipoProveedor delegadoAnticipoProveedor = new DelegadoAnticipoProveedor();
			VentBuscarAnticipoProveedor ventBuscarAnticipoProveedor = new VentBuscarAnticipoProveedor(VentRegistrarPagoAbonoCxP.this, true);
			List<AnticipoProveedor> anticipos = delegadoAnticipoProveedor.listarAnticipoProveedorPorIdentificacion(identificacion);
			ventBuscarAnticipoProveedor.agregarDatosAnticipos(anticipos);
			ventBuscarAnticipoProveedor.setVisible(true);
			calcularSaldoAPagar();
			
		}catch(NullPointerException nl){
			VentBuscarAnticipoProveedor ventBuscarAnticipoProveedor = new VentBuscarAnticipoProveedor(VentRegistrarPagoAbonoCxP.this, true);
			ventBuscarAnticipoProveedor.setVisible(true);
			calcularSaldoAPagar();
			nl.getMessage();
		}
		
	}

	//Metodo para cargar los datos de la devolucion a la ventana de devoluciones proveedor
	public void cargarADevolucionProveedor(String identificacion){
		
		try{
			DelegadoDevolucionProveedor delegadoDevolucionProveedor = new DelegadoDevolucionProveedor();
			VentBuscarDevolucionProveedor ventBuscarDevolucionProveedor = new VentBuscarDevolucionProveedor(VentRegistrarPagoAbonoCxP.this, true);
			List<DevolucionProveedor> devoluciones = delegadoDevolucionProveedor.listarDevolucionProveedorPorIdentificacion(identificacion);
			ventBuscarDevolucionProveedor.agregarDatosDevoluciones(devoluciones);
			ventBuscarDevolucionProveedor.setVisible(true);
			calcularSaldoAPagar();
			
		}catch(NullPointerException nl){
			VentBuscarDevolucionProveedor ventBuscarDevolucionProveedor = new VentBuscarDevolucionProveedor(VentRegistrarPagoAbonoCxP.this, true);
			ventBuscarDevolucionProveedor.setVisible(true);
			calcularSaldoAPagar();
			nl.getMessage();
		}
	}
		
	//Metodo para generar un nuevo egreso cuando se pague la totalidad de la cuenta por pagar
	private void registrarEgreso() {
		Egreso egreso = new Egreso();
		DelegadoEgreso delegadoEgreso = new DelegadoEgreso();
		
		egreso.setIdentificacionProv(idProveedor);
		egreso.setConcepto(txtConcepto.getText());
		egreso.setDocSoporte(Integer.parseInt(txtDocSoporte.getText()));
		egreso.setFechaGeneracion(new Date());
		egreso.setFechaPago(dchFechaPago.getDate());
		egreso.setSubtotal(Double.parseDouble(txtSubtotal.getValue().toString()));
		egreso.setTotalPagado(Double.parseDouble(txtPagoAbono.getValue().toString()));
		egreso.setOtros(Double.parseDouble(txtOtros.getValue().toString()));
		MedioPagoProv medioPago1 = new MedioPagoProv();
		MedioPagoProv medioPago2 = new MedioPagoProv();
		medioPago1 = (MedioPagoProv)cbFormaPago1.getSelectedItem();
		medioPago1.setIdMedioPagoProv(medioPago1.getIdMedioPagoProv());
		egreso.setMedioPagoProv1(medioPago1);
		if(cbFormaPago2.getSelectedItem().equals("--NINGUNA--")){
			egreso.setMedioPagoProv2(null);
		}else{
			medioPago2 = (MedioPagoProv)cbFormaPago2.getSelectedItem();
			medioPago2.setIdMedioPagoProv(medioPago2.getIdMedioPagoProv());
			egreso.setMedioPagoProv2(medioPago2);
		}
		egreso.setValorPago1(Double.parseDouble(txtValorPago1.getValue().toString()));
		egreso.setValorPago2(Double.parseDouble(txtValorPago2.getValue().toString()));
		egreso.setObservaciones(txpObservaciones.getText());
		egreso.setIdCuentaXPagar(Integer.parseInt(txtCxP.getText()));
		egreso.setEstadoActividad("Activo");
		
		delegadoEgreso.insertarEgreso(egreso);
		codigoEgreso= delegadoEgreso.traerCodigoEgreso();
		
		idEgreso= codigoEgreso.get(0).getIdEgreso();
		fechaEgreso = codigoEgreso.get(0).getFechaPago();
		
		cambiarEstadoCxP();
		contabilizarEgreso();
	}
	//Metodo para cambiar el texto del boton cuando se va pagar totalmente la cxp o simplemente se va abonar
	private void cambiarTextoBotonPagarAbonar(){
		
		if(calcularNuevoSaldo()==0){
			btnPagarCxP.setText("Pagar la CxP");
		}else{
			btnPagarCxP.setText("Abonar la CxP");
		}
	}
	//Metodo para cambiar el estado de la cuenta por pagar de pendiente a pagado
	private void cambiarEstadoCxP(){
		DelegadoCuentaXPagar delegadoCuentaXPagar = new DelegadoCuentaXPagar();
		List<CuentaXPagar> codigoCxP= delegadoCuentaXPagar.traerCuentaXPagarPorCodigo(Integer.parseInt(txtCxP.getText()));
		CuentaXPagar cxpAModificar = codigoCxP.get(0);
		
		cxpAModificar.setEstado("Pagado");
		delegadoCuentaXPagar.actualizarCuentaXPagar(cxpAModificar);
	}
	
	//Metodo para convertir un numero corriente en formato de pesos y decimales
	private String formatearNumero(Double numero){
		NumberFormat formato = NumberFormat.getCurrencyInstance(new Locale("es","CO"));
		return formato.format(numero); 
	}
	
	//Metodo para convertir un numero en formato de pesos y decimales en un numero corriente
	private String desformatearNumero(String numero){
		String numeroReemplazado=numero.replace("$", "");
		String numeroReemplazado1=numeroReemplazado.replace(".", "");
		String numeroReemplazado2=numeroReemplazado1.replace(",", ".");
		return numeroReemplazado2;
	}
	
	private void cambiarEstadoAnticipo(){
		DelegadoAnticipoProveedor delegadoAnticipoProveedor = new DelegadoAnticipoProveedor();
		AnticipoProveedor anticipoAModificar;
		List<AnticipoProveedor> codigoAnticipo;
		List<String> anticiposSeleccionados = VentBuscarAnticipoProveedor.listarIdAnticiposSeleccionados();
		
		for( int i = 0; i < anticiposSeleccionados.size(); i++){
			codigoAnticipo = delegadoAnticipoProveedor.traerAnticipoProveedorPorCodigo(Integer.parseInt(anticiposSeleccionados.get(i)));
			anticipoAModificar = codigoAnticipo.get(i);
			anticipoAModificar.setEstadoAnticipo("Descontada");
			delegadoAnticipoProveedor.actualizarAnticipoProveedor(anticipoAModificar);
		}
	}
	
	private void cambiarEstadoDevolucion(){
		DelegadoDevolucionProveedor delegadoDevolucionProveedor = new DelegadoDevolucionProveedor();
		DevolucionProveedor devolucionAModificar;
		List<DevolucionProveedor> codigoDevolucion;
		List<String> devolucionesSeleccionados = VentBuscarDevolucionProveedor.listarIdDevolucionesSeleccionados();
		
		for( int i = 0; i < devolucionesSeleccionados.size(); i++){
			codigoDevolucion = delegadoDevolucionProveedor.traerDevolucionProveedorPorCodigo(Integer.parseInt(devolucionesSeleccionados.get(i)));
			devolucionAModificar = codigoDevolucion.get(i);
			devolucionAModificar.setEstado("Descontada");
			devolucionAModificar.setFechaEgreso(fechaEgreso);
			devolucionAModificar.setIdEgreso(idEgreso);
			delegadoDevolucionProveedor.actualizarDevolucionProveedor(devolucionAModificar);
		}
	}
	
	//Metodo para contabilizar la cuenta por pagar cuando se abona
	private void contabilizarPagoAbono() {
		DelegadoContabilizacion delegadoContabilizacion = new DelegadoContabilizacion();                                                                                   
		Contabilizacion contabilizarAProveedor = new Contabilizacion();                                                                 
		Contabilizacion contabilizarABanco = new Contabilizacion();
		Contabilizacion contabilizarACaja = new Contabilizacion();
		Contabilizacion contabilizarACuentaPagar = new Contabilizacion(); 
		
		if("Compra".equals(txtConcepto.getText())){
			contabilizarAProveedor.setCodigoCuenta(2205);
			contabilizarAProveedor.setFechaGeneracion(new Date());              
			contabilizarAProveedor.setNombreCuenta("Proveedores Nacionales");
			contabilizarAProveedor.setSaldoDebito(codigoPagoAbonoCxP.get(0).getPagoAbono());
			contabilizarAProveedor.setSaldoCredito(0);
			
			delegadoContabilizacion.insertarContabilizacion(contabilizarAProveedor); 
			
			if("Bancos".equals(codigoPagoAbonoCxP.get(0).getMedioPagoProv1().getNombreCuenta())){
				contabilizarABanco.setCodigoCuenta(1110);
				contabilizarABanco.setFechaGeneracion(new Date());
				contabilizarABanco.setNombreCuenta("Bancos");
				contabilizarABanco.setSaldoDebito(0);
				contabilizarABanco.setSaldoCredito(codigoPagoAbonoCxP.get(0).getValorPago1());
				
				delegadoContabilizacion.insertarContabilizacion(contabilizarABanco);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			}else{
				if("Caja".equals(codigoPagoAbonoCxP.get(0).getMedioPagoProv1().getNombreCuenta())){
					contabilizarACaja.setCodigoCuenta(1105);
					contabilizarACaja.setFechaGeneracion(new Date());
					contabilizarACaja.setNombreCuenta("Caja");
					contabilizarACaja.setSaldoDebito(0);
					contabilizarACaja.setSaldoCredito(codigoPagoAbonoCxP.get(0).getValorPago1());
					
					delegadoContabilizacion.insertarContabilizacion(contabilizarACaja); 
				}
			}
			
			if("Bancos".equals(codigoPagoAbonoCxP.get(0).getMedioPagoProv2().getNombreCuenta())){
				contabilizarABanco.setCodigoCuenta(1110);
				contabilizarABanco.setFechaGeneracion(new Date());
				contabilizarABanco.setNombreCuenta("Bancos");
				contabilizarABanco.setSaldoDebito(0);
				contabilizarABanco.setSaldoCredito(codigoPagoAbonoCxP.get(0).getValorPago1());
				
				delegadoContabilizacion.insertarContabilizacion(contabilizarABanco);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			}else{
				if("Caja".equals(codigoPagoAbonoCxP.get(0).getMedioPagoProv2().getNombreCuenta())){
					contabilizarACaja.setCodigoCuenta(1105);
					contabilizarACaja.setFechaGeneracion(new Date());
					contabilizarACaja.setNombreCuenta("Caja");
					contabilizarACaja.setSaldoDebito(0);
					contabilizarACaja.setSaldoCredito(codigoPagoAbonoCxP.get(0).getValorPago1());
					
					delegadoContabilizacion.insertarContabilizacion(contabilizarACaja); 
				}
			}
		}else{
			contabilizarACuentaPagar.setCodigoCuenta(2335);
			contabilizarACuentaPagar.setFechaGeneracion(new Date());              
			contabilizarACuentaPagar.setNombreCuenta("Cuentas por Pagar");
			contabilizarACuentaPagar.setSaldoDebito(codigoPagoAbonoCxP.get(0).getPagoAbono());
			contabilizarACuentaPagar.setSaldoCredito(0);
			
			delegadoContabilizacion.insertarContabilizacion(contabilizarAProveedor); 
			
			if("Bancos".equals(codigoPagoAbonoCxP.get(0).getMedioPagoProv1().getNombreCuenta())){
				contabilizarABanco.setCodigoCuenta(1110);
				contabilizarABanco.setFechaGeneracion(new Date());
				contabilizarABanco.setNombreCuenta("Bancos");
				contabilizarABanco.setSaldoDebito(0);
				contabilizarABanco.setSaldoCredito(codigoPagoAbonoCxP.get(0).getValorPago1());
				
				delegadoContabilizacion.insertarContabilizacion(contabilizarABanco);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			}else{
				if("Caja".equals(codigoPagoAbonoCxP.get(0).getMedioPagoProv1().getNombreCuenta())){
					contabilizarACaja.setCodigoCuenta(1105);
					contabilizarACaja.setFechaGeneracion(new Date());
					contabilizarACaja.setNombreCuenta("Caja");
					contabilizarACaja.setSaldoDebito(0);
					contabilizarACaja.setSaldoCredito(codigoPagoAbonoCxP.get(0).getValorPago1());
					
					delegadoContabilizacion.insertarContabilizacion(contabilizarACaja); 
				}
			}
			
			if("Bancos".equals(codigoPagoAbonoCxP.get(0).getMedioPagoProv2().getNombreCuenta())){
				contabilizarABanco.setCodigoCuenta(1110);
				contabilizarABanco.setFechaGeneracion(new Date());
				contabilizarABanco.setNombreCuenta("Bancos");
				contabilizarABanco.setSaldoDebito(0);
				contabilizarABanco.setSaldoCredito(codigoPagoAbonoCxP.get(0).getValorPago1());
				
				delegadoContabilizacion.insertarContabilizacion(contabilizarABanco);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			}else{
				if("Caja".equals(codigoPagoAbonoCxP.get(0).getMedioPagoProv2().getNombreCuenta())){
					contabilizarACaja.setCodigoCuenta(1105);
					contabilizarACaja.setFechaGeneracion(new Date());
					contabilizarACaja.setNombreCuenta("Caja");
					contabilizarACaja.setSaldoDebito(0);
					contabilizarACaja.setSaldoCredito(codigoPagoAbonoCxP.get(0).getValorPago1());
					
					delegadoContabilizacion.insertarContabilizacion(contabilizarACaja); 
				}
			}
		}
	}
	
	//Metodo para contabilizar la cuenta por pagar cuando se paga en su totalidad
	private void contabilizarEgreso() {
		DelegadoContabilizacion delegadoContabilizacion = new DelegadoContabilizacion();                                                                                   
		Contabilizacion contabilizarAProveedor = new Contabilizacion();                                                                 
		Contabilizacion contabilizarABanco = new Contabilizacion();
		Contabilizacion contabilizarACaja = new Contabilizacion();
		
		if("Compra".equals(txtConcepto.getText())){
			contabilizarAProveedor.setCodigoCuenta(2205);
			contabilizarAProveedor.setFechaGeneracion(new Date());              
			contabilizarAProveedor.setNombreCuenta("Proveedores Nacionales");
			contabilizarAProveedor.setSaldoDebito(codigoEgreso.get(0).getTotalPagado());
			contabilizarAProveedor.setSaldoCredito(0);
			
			delegadoContabilizacion.insertarContabilizacion(contabilizarAProveedor); 
			
			if("Bancos".equals(codigoEgreso.get(0).getMedioPagoProv1().getNombreCuenta())){
				contabilizarABanco.setCodigoCuenta(1110);
				contabilizarABanco.setFechaGeneracion(new Date());
				contabilizarABanco.setNombreCuenta("Bancos");
				contabilizarABanco.setSaldoDebito(0);
				contabilizarABanco.setSaldoCredito(codigoEgreso.get(0).getValorPago1());
				
				delegadoContabilizacion.insertarContabilizacion(contabilizarABanco);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			}else{
				if("Caja".equals(codigoEgreso.get(0).getMedioPagoProv1().getNombreCuenta())){
					contabilizarACaja.setCodigoCuenta(1105);
					contabilizarACaja.setFechaGeneracion(new Date());
					contabilizarACaja.setNombreCuenta("Caja");
					contabilizarACaja.setSaldoDebito(0);
					contabilizarACaja.setSaldoCredito(codigoEgreso.get(0).getValorPago1());
					
					delegadoContabilizacion.insertarContabilizacion(contabilizarACaja); 
				}
			}
			
			if("Bancos".equals(codigoEgreso.get(0).getMedioPagoProv2().getNombreCuenta())){
				contabilizarABanco.setCodigoCuenta(1110);
				contabilizarABanco.setFechaGeneracion(new Date());
				contabilizarABanco.setNombreCuenta("Bancos");
				contabilizarABanco.setSaldoDebito(0);
				contabilizarABanco.setSaldoCredito(codigoEgreso.get(0).getValorPago1());
				
				delegadoContabilizacion.insertarContabilizacion(contabilizarABanco);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			}else{
				if("Caja".equals(codigoEgreso.get(0).getMedioPagoProv2().getNombreCuenta())){
					contabilizarACaja.setCodigoCuenta(1105);
					contabilizarACaja.setFechaGeneracion(new Date());
					contabilizarACaja.setNombreCuenta("Caja");
					contabilizarACaja.setSaldoDebito(0);
					contabilizarACaja.setSaldoCredito(codigoEgreso.get(0).getValorPago1());
					
					delegadoContabilizacion.insertarContabilizacion(contabilizarACaja); 
				}
			}
		}else{
			contabilizarAProveedor.setCodigoCuenta(5135);
			contabilizarAProveedor.setFechaGeneracion(new Date());              
			contabilizarAProveedor.setNombreCuenta("Gastos de Administracin");
			contabilizarAProveedor.setSaldoDebito(codigoEgreso.get(0).getTotalPagado());
			contabilizarAProveedor.setSaldoCredito(0);
			
			delegadoContabilizacion.insertarContabilizacion(contabilizarAProveedor); 
			
			if("Bancos".equals(codigoEgreso.get(0).getMedioPagoProv1().getNombreCuenta())){
				contabilizarABanco.setCodigoCuenta(1110);
				contabilizarABanco.setFechaGeneracion(new Date());
				contabilizarABanco.setNombreCuenta("Bancos");
				contabilizarABanco.setSaldoDebito(0);
				contabilizarABanco.setSaldoCredito(codigoEgreso.get(0).getValorPago1());
				
				delegadoContabilizacion.insertarContabilizacion(contabilizarABanco);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			}else{
				if("Caja".equals(codigoEgreso.get(0).getMedioPagoProv1().getNombreCuenta())){
					contabilizarACaja.setCodigoCuenta(1105);
					contabilizarACaja.setFechaGeneracion(new Date());
					contabilizarACaja.setNombreCuenta("Caja");
					contabilizarACaja.setSaldoDebito(0);
					contabilizarACaja.setSaldoCredito(codigoEgreso.get(0).getValorPago1());
					
					delegadoContabilizacion.insertarContabilizacion(contabilizarACaja); 
				}
			}
			
			if("Bancos".equals(codigoEgreso.get(0).getMedioPagoProv2().getNombreCuenta())){
				contabilizarABanco.setCodigoCuenta(1110);
				contabilizarABanco.setFechaGeneracion(new Date());
				contabilizarABanco.setNombreCuenta("Bancos");
				contabilizarABanco.setSaldoDebito(0);
				contabilizarABanco.setSaldoCredito(codigoEgreso.get(0).getValorPago1());
				
				delegadoContabilizacion.insertarContabilizacion(contabilizarABanco);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
			}else{
				if("Caja".equals(codigoEgreso.get(0).getMedioPagoProv2().getNombreCuenta())){
					contabilizarACaja.setCodigoCuenta(1105);
					contabilizarACaja.setFechaGeneracion(new Date());
					contabilizarACaja.setNombreCuenta("Caja");
					contabilizarACaja.setSaldoDebito(0);
					contabilizarACaja.setSaldoCredito(codigoEgreso.get(0).getValorPago1());
					
					delegadoContabilizacion.insertarContabilizacion(contabilizarACaja); 
				}
			}
		}
	}
}

